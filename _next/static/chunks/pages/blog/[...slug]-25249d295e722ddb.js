(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94],{96082:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/[...slug]",function(){return t(53832)}])},53832:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return q},default:function(){return J}});var r=t(85893),a=t(44816),i=t(72355),s=t(75532),c=t(84283),l=t(87690);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){o(e,n,t[n])}))}return e}function d(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var m={h1:"h2",h2:"h3",code:function(e){e.node;var n,t,a=e.inline,i=e.className,l=e.children,o=d(e,["node","inline","className","children"]),m=null===(n=/language-(?:diff-)*(.+)\b/.exec(i||""))||void 0===n?void 0:n[1],h=null===(t=/\b(\w+)\b$/.exec(i||""))||void 0===t?void 0:t[1];if(!h||a)return(0,r.jsx)("code",u({className:i},o,{children:l}));var g=m!==h?m:"",j=String(l).replace(/\n$/,""),b=[],N=[],w=[];return j.split("\n").forEach((function(e,n){v.test(e)?b.push(n):p.test(e)?w.push(n):y.test(e)&&N.push(n)})),j=j.replaceAll(x,""),(0,r.jsx)(s.Z,u({language:h,style:c.YC,before:g,codeTagProps:{style:[]},wrapLines:!0,renderer:f({linesHl:b,linesAdd:N,linesDel:w}),className:""},o,{children:j}))}};function h(e){var n=e.children,t=d(e,["children"]);return(0,r.jsx)(a.D,u({remarkPlugins:[i.Z],components:m},t,{children:n}))}function f(e){var n=e.linesHl,t=e.linesAdd,r=e.linesDel;return function(e){var a=e.rows,i=e.stylesheet,s=e.useInlineStyles;return a.map((function(e,a){return n&&n.includes(a)?e.properties.className=["line line-hl"]:t&&t.includes(a)?e.properties.className=["line line-add"]:r&&r.includes(a)?e.properties.className=["line line-del"]:e.properties.className=[],(0,l.ZP)({node:e,stylesheet:i,useInlineStyles:s,key:"code-segement".concat(a)})}))}}var x=/\/\/\s*(highlight|add|delete)-line$/gm,v=/\/\/\s*highlight-line$/,p=/\/\/\s*delete-line$/,y=/\/\/\s*add-line$/;var g=t(67294),j=t(16605),b=t(94184),N=t.n(b),w=t(38197),O=t(84243),C=t(34051),k=t.n(C),S=t(31838),P=t(37813);function D(e,n,t,r,a,i,s){try{var c=e[i](s),l=c.value}catch(o){return void t(o)}c.done?n(l):Promise.resolve(l).then(r,a)}function E(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function s(e){D(i,r,a,s,c,"next",e)}function c(e){D(i,r,a,s,c,"throw",e)}s(void 0)}))}}var I=S.v.soldisc.chainId;function A(e){var n=(0,P.GP)().soldisc,t=(0,j.HM)(),r="PostQuery"+e,a=function(){var r=E(k().mark((function r(){var a;return k().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getCommentsByPost(e,t);case 2:return a=r.sent,r.abrupt("return",{comments:a});case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return(0,P.LQ)({key:r,fetchState:a,chainId:I})}var _=t(57458),L=t.n(_),T=t(67814),H=t(56024),$=t(51436);function G(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function M(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){M(e,n,t[n])}))}return e}function Q(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function U(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i=[],s=!0,c=!1;try{for(t=t.call(e);!(s=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);s=!0);}catch(l){c=!0,a=l}finally{try{s||null==t.return||t.return()}finally{if(c)throw a}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return G(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return G(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z=S.v.soldisc.chainId;function X(e){e.value;var n=e.children,t=Q(e,["value","children"]);return(0,r.jsx)("div",{className:"break-words",children:(0,r.jsx)(h,z({},t,{children:n}))})}function B(e){var n=e.address,t=e.userName;return(0,r.jsx)(j.rU,{href:(0,j.st)(n,Z),children:(0,r.jsx)("span",{className:"text-primary-400",children:t})})}function F(e){var n,t=e.postHash,a=e.commentId,i=e.user,s=e.userName,c=e.text,l=e.creationDate,o=e.editDate,u=e.numLikes,d=e.liked,m=(Q(e,["postHash","commentId","user","userName","text","creationDate","editDate","numLikes","liked"]),(0,j.HM)()),h=(0,j.yw)(),f=(0,j.pC)(),x=null===h||void 0===h?void 0:h.getSigner(),v=(0,P.GP)(),p=v.soldisc,y=v.handleTx,b=v.handleTxError,w=(0,g.useState)(!1),O=w[0],C=w[1],k=(0,g.useState)(""),S=k[0],D=k[1],E=f===Z&&m,I=U(A(t),2)[1],_=m===i;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-x-4 text-slate-400",children:[(0,r.jsx)(B,{address:i,userName:s}),(0,r.jsx)("span",{className:"text-sm hidden sm:block",children:new Date(l.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),(0,r.jsxs)("span",{className:N()("text-sm",0==u&&"text-slate-500"),children:[u.toString(),(0,r.jsx)(T.G,{className:N()("ml-2 text-base transition-colors duration-200 cursor-pointer",d?"text-secondary-400 hover:text-slate-300":"text-slate-400 hover:text-secondary-400"),onClick:(n=function(){p.connect(x).toggleLikeComment(t,a).then(y).then(I).catch(b)},E?n:function(){return j.i8.activate(Z)}),icon:d?$.m6i:H.m6i})]}),o>0&&(0,r.jsxs)("span",{className:"text-sm text-slate-500 hidden sm:block",children:["(edited:"," ",new Date(o.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),")"]})]}),O?(0,r.jsx)(R,{value:S,onChange:function(e){return D(e.target.value)},onClick:function(e){return p.connect(x).editComment(t,a,e).then(y).then((function(){return C(!1)})).then(I).catch(b)},onCancel:function(){return C(!1)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X,{children:c}),_&&(0,r.jsx)("div",{className:"flex justify-center text-xs",children:(0,r.jsx)(j.zx,{className:"",variant:"text",onClick:function(){D(c),C(!0)},children:"Edit"})})]})]})}function R(e){var n,t,a=e.value,i=e.onClick,s=e.onChange,c=e.onCancel,l=e.placeholder,o=e.text,u=e.loadingText,d=(e.children,(0,g.useState)(!1)),m=d[0],h=d[1],f=L().encode(a),x=4<f.length&&f.length<1e3,v=(0,j.HM)(),p=(0,j.pC)()===Z&&v;return(0,r.jsxs)("div",{children:[(0,r.jsx)(j.II,{className:"mt-2",variant:"outlined",placeholder:l,multiline:!0,invalid:a&&!x,value:a,onChange:s}),a&&(0,r.jsx)("p",{className:"text-slate-400 my-2",children:"Preview:"}),(0,r.jsx)(X,{children:L().decode(f)}),(0,r.jsxs)("div",{className:"flex justify-center p-2",children:[c&&!m&&(0,r.jsx)(j.zx,{variant:"text",onClick:c,children:"Cancel"}),(0,r.jsx)(j.fl,{loading:m,disabled:!x,className:"",variant:"text",onClick:(t=i,p?function(){h(!0),t(f).finally((function(){return h(!1)}))}:function(){return j.i8.activate(Z)}),children:m?null!==(n=o&&u)&&void 0!==n?n:"Editing":null!==o&&void 0!==o?o:"Edit"})]})]})}function Y(e){var n=e.slug,t=(0,j.HM)(),a=(0,j.yw)(),i=(0,j.pC)(),s=null===a||void 0===a?void 0:a.getSigner(),c=(0,P.GP)(),l=c.soldisc,o=c.handleTx,u=c.handleTxError,d=w.w(O.$.encode(["string"],[n.join("/")])),m=U(function(e){var n=(0,P.GP)().soldisc,t=function(){var t=E(k().mark((function t(){var r;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.accounts(e);case 2:return r=t.sent,t.abrupt("return",{userAccount:r});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,P.LQ)({key:"UserQuery",fetchState:t,chainId:I})}(t),2),h=m[0].userAccount,f=m[1],x=U(A(d),2),v=x[0],p=v.comments,y=v.loaded,b=x[1],N=(0,g.useState)(""),C=N[0],S=N[1],D=(0,g.useState)(""),_=D[0],T=D[1],H=i===Z&&t,$=(null===h||void 0===h?void 0:h.creationDate)>0;return(0,g.useEffect)((function(){j.i8.connectEagerly()}),[]),(0,r.jsxs)("div",{className:"bg-slate-800/40 text-slate-300 -mx-4 px-4 p-4 rounded-xl border border-white/20",children:[(0,r.jsxs)("div",{className:"text-lg py-2",children:[(0,r.jsx)("span",{className:"font-display bg-gradient-to-r from-primary-400 to-secondary-500 bg-clip-text text-transparent",children:"SolDisc"})," ",(0,r.jsx)("span",{className:"text-sm text-slate-400",children:"- On-Chain Discourse"})]}),y?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"border-y border-white/40 pt-3 mb-4",children:[(0,r.jsx)("p",{className:"text-slate-400 text-sm",children:"Leave a comment:"}),$?(0,r.jsx)(B,{address:t,userName:h.name}):(0,r.jsx)("div",{children:(0,r.jsx)(j.II,{className:"mt-2",variant:"outlined",placeholder:"username",value:_,invalid:_&&!(4<=_.length&&_.length<=20),onChange:function(e){return T(e.target.value)}})}),(0,r.jsx)(R,{value:C,onChange:function(e){return S(e.target.value)},placeholder:$?"":"comment",onClick:function(){return($?l.connect(s).commentOnPost(d,L().encode(C)):l.connect(s).createAccountAndComment(_,"",d,L().encode(C))).then(o).then(f).then(b).then((function(){return S("")})).catch(u)},text:$?"Comment":"Create Account & Comment",loadingText:$?"Commenting":"Creating Account & Commenting"})]}),(null===p||void 0===p?void 0:p.length)<1&&(0,r.jsx)("p",{children:"No Comments yet"}),(0,r.jsx)("div",{className:"flex flex-col gap-y-4",children:y&&p.map((function(e,n){return(0,r.jsx)(F,z({postHash:d,commentId:n},e),n)})).reverse()})]}):(0,r.jsx)("div",{className:"flex justify-center m-4",children:H?"loading...":(0,r.jsx)(j.zx,{variant:"text",onClick:function(){return j.i8.activate(Z)},children:i!==Z?"Connect to ".concat(j.zG[Z].name):"Connect your MetaMask!"})})]})}var q=!0;function J(e){var n=e.postData;return(0,r.jsxs)("div",{className:"flex flex-col justify-between gap-y-20",children:[(0,r.jsxs)("div",{className:"content markdown",children:[(0,r.jsx)("h1",{className:"text-center",children:n.title}),n.suptitle&&(0,r.jsx)("h2",{className:"text-center",children:n.suptitle}),(0,r.jsx)("p",{className:"text-slate-500 text-sm text-center",children:new Date(n.date).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),(0,r.jsx)(h,{className:"mt-16",children:n.contentRaw})]}),(0,r.jsx)(Y,{slug:n.slug})]})}}},function(e){e.O(0,[766,566,774,888,179],(function(){return n=96082,e(e.s=n);var n}));var n=e.O();_N_E=n}]);