(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94],{96082:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/[...slug]",function(){return t(28419)}])},28419:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return ne},default:function(){return te}});var r=t(85893),s=t(11163),l=t(82960),a=t(97e3),i=t(75532),c=t(84283),o=t(87690),d=t(26802),u=t(38522),h=t(68141),m=t(491),f=t(34699),x=t(52935),v=t(31947),p=t(71015),j=t(41664);t(97604);function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){g(e,n,t[n])}))}return e}function b(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function N(e){var n=e.children,t=e.trusted,s=b(e,["children","trusted"]);return(0,r.jsx)(l.D,y({remarkPlugins:t?[a.Z,u.Z,d.Z]:[a.Z],rehypePlugins:t?[h.Z,m.Z,f.Z,x.Z,v.Z]:[],components:{h1:"h2",h2:function(e){var n=e.children,t=b(e,["children"]);return(0,r.jsx)("h3",{id:t.id,children:n})},code:function(e){return(0,r.jsx)(D,y({trusted:t},e))},a:function(e){var n=e.href,t=e.children,s=(e.node,b(e,["href","children","node"]));return/^https\:\/\//.test(n)?(0,r.jsx)(p.dL,y({href:n},s,{children:t})):(0,r.jsx)(j.default,y({href:n},s,{children:(0,r.jsx)("a",{children:t})}))}}},s,{children:n}))}function O(e){var n=e.linesHl,t=e.linesAdd,r=e.linesDel;return function(e){var s=e.rows,l=e.stylesheet,a=e.useInlineStyles;return s.map((function(e,s){return n&&n.includes(s)?e.properties.className=["line line-hl"]:t&&t.includes(s)?e.properties.className=["line line-add"]:r&&r.includes(s)?e.properties.className=["line line-del"]:e.properties.className=[],(0,o.ZP)({node:e,stylesheet:l,useInlineStyles:a,key:"code-segement".concat(s)})}))}}var w=/\/\/\s*(hl|highlight|add|delete|del|remove)-line$/gm,C=/\/\/\s*(hl|highlight)-line$/,S=/\/\/\s*(del|delete|remove)-line$/,k=/\/\/\s*add-line$/;function D(e){e.node;var n,t,s=e.inline,l=e.trusted,a=e.className,o=e.children,d=b(e,["node","inline","trusted","className","children"]),u=null===(n=/language-(?:diff-)*(.+)\b/.exec(a||""))||void 0===n?void 0:n[1],h=null===(t=/\b(\w+)\b$/.exec(a||""))||void 0===t?void 0:t[1];if(!h||s)return(0,r.jsx)("code",y({className:a},d,{children:o}));var m=u!==h?u:"",f=String(o).replace(/\n$/,""),x=[],v=[],p=[];return l&&(f.split("\n").forEach((function(e,n){C.test(e)?x.push(n):S.test(e)?p.push(n):k.test(e)&&v.push(n)})),f=f.replaceAll(w,"")),(0,r.jsx)(i.Z,y({language:h,style:c.YC,before:m,codeTagProps:{style:[]},wrapLines:!0,renderer:O({linesHl:x,linesAdd:v,linesDel:p}),className:""},d,{children:f}))}var P=t(67294),I=t(94184),E=t.n(I),_=t(38197),A=t(84243),L=t(9279),M=t(57458),T=t.n(M),Z=t(67814),$=t(56024),G=t(51436),z=t(31838),H=t(12641);function Q(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function q(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function B(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){q(e,n,t[n])}))}return e}function R(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}function U(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,s,l=[],a=!0,i=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(l.push(r.value),!n||l.length!==n);a=!0);}catch(c){i=!0,s=c}finally{try{a||null==t.return||t.return()}finally{if(i)throw s}}return l}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return Q(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Q(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=z.v.soldisc.chainId;function F(e){var n=(0,p.ti)();return(0,H.LQ)(z.v.soldisc.address,"getCommentsByPost",[e,n||L.d])}function Y(e){e.value;var n=e.children,t=R(e,["value","children"]);return(0,r.jsx)("div",{className:"break-words",children:(0,r.jsx)(N,B({},t,{children:n}))})}function J(e){var n=e.address,t=e.userName,s=e.setModalData;return(0,r.jsx)("span",{className:"text-primary-400 link",onClick:function(){return s({address:n,userName:t})},children:t})}function K(e){var n=e.postHash,t=e.commentId,s=e.user,l=e.userName,a=e.text,i=e.creationDate,c=e.editDate,o=e.numLikes,d=e.liked,u=e.setModalData,h=(0,p.ti)(),m=(0,p.Mu)(),f=null===m||void 0===m?void 0:m.getSigner(),x=(0,H.GP)(),v=x.soldisc,j=x.handleTx,g=x.handleTxError,y=(0,P.useState)(!1),b=y[0],N=y[1],O=(0,P.useState)(""),w=O[0],C=O[1],S=U(F(n),2)[1],k=h===s,D=(0,p.xh)(z.v.soldisc.chainId);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-x-4 text-slate-400",children:[(0,r.jsx)(J,{address:s,userName:l,setModalData:u}),(0,r.jsx)("span",{className:"text-sm hidden sm:block",children:new Date(i.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),(0,r.jsxs)("span",{className:E()("text-sm",0==o&&"text-slate-500"),children:[o.toString(),(0,r.jsx)(Z.G,{className:E()("ml-2 text-base transition-colors duration-200 cursor-pointer",d?"text-secondary-400 hover:text-slate-300":"text-slate-400 hover:text-secondary-400"),onClick:D((function(){n&&v.connect(f).toggleLikeComment(n,t).then(j).then(S).catch(g)})),icon:d?G.m6i:$.m6i})]}),c>0&&(0,r.jsxs)("span",{className:"text-sm text-slate-500 hidden sm:block",children:["(edited:"," ",new Date(c.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),")"]})]}),b?(0,r.jsx)(V,{value:w,onChange:function(e){return C(e.target.value)},onClick:function(e){n&&v.connect(f).editComment(n,t,e).then(j).then((function(){return N(!1)})).then(S).catch(g)},onCancel:function(){return N(!1)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{children:a}),k&&n&&(0,r.jsx)("div",{className:"flex justify-center text-xs",children:(0,r.jsx)(p.zx,{className:"",variant:"text",onClick:function(){C(a),N(!0)},children:"Edit"})})]})]})}function V(e){var n,t=e.value,s=e.onClick,l=e.onChange,a=e.onCancel,i=e.placeholder,c=e.text,o=e.loadingText,d=(e.children,(0,P.useState)(!1)),u=d[0],h=d[1],m=T().encode(t),f=4<m.length&&m.length<1e3,x=(0,p.xh)(z.v.soldisc.chainId);return(0,r.jsxs)("div",{children:[(0,r.jsx)(p.II,{className:"mt-2",variant:"outlined",type:"multiline",placeholder:i,invalid:t&&!f,value:t,onChange:l}),t&&(0,r.jsx)("p",{className:"text-slate-400 my-2",children:"Preview:"}),(0,r.jsx)(Y,{children:T().decode(m)}),(0,r.jsxs)("div",{className:"flex justify-center p-2",children:[a&&!u&&(0,r.jsx)(p.zx,{variant:"text",onClick:a,children:"Cancel"}),(0,r.jsx)(p.fl,{loading:u,disabled:!f,className:"",variant:"text",onClick:x((function(){h(!0),s(m).finally((function(){return h(!1)}))})),children:u?null!==(n=c&&o)&&void 0!==n?n:"Editing":null!==c&&void 0!==c?c:"Edit"})]})]})}function W(e){var n,t=e.userName,s=e.address,l=e.setModalData,a=U((n=s,console.log("here"),(0,H.LQ)(z.v.soldisc.address,"getCommentsByUser",[n])),1)[0],i=(0,p.pN)();return(0,r.jsx)(p.u_,{open:!!s,onClose:function(){return l({})},children:(0,r.jsxs)("div",{className:"bg-slate-900 flex flex-col p-8 max-w-xl",children:[(0,r.jsxs)("div",{className:"flex items-end gap-x-3",children:[(0,r.jsx)(p.dL,{href:(0,p.st)(i,s),children:(0,r.jsx)("h2",{className:"btn",children:t})}),(0,r.jsx)(p.dL,{href:(0,p.st)(i,s),children:(0,r.jsx)("span",{className:"",children:s})})]}),(0,r.jsx)("div",{className:"mt-4",children:void 0!==a&&a.map((function(e,n){return(0,r.jsx)(K,B({commentId:n,setModalData:l},e),n)})).reverse()})]})})}function ee(e){var n=e.slug,t=(0,P.useState)({}),s=t[0],l=t[1],a=(0,P.useState)(""),i=a[0],c=a[1],o=(0,P.useState)(""),d=o[0],u=o[1],h=(0,p.ti)(),m=(0,p.Mu)(),f=(0,p.pN)(),x=null===m||void 0===m?void 0:m.getSigner(),v=(0,H.GP)(),j=v.soldisc,g=v.handleTx,y=v.handleTxError,b=n.join("/");"2022/soldisc"===b&&(b="2021/soldisc");var N=_.keccak256(A.$.encode(["string"],[b])),O=U(function(e){return(0,H.LQ)(z.v.soldisc.address,"accounts",[e])}(h),2),w=O[0],C=O[1],S=U(F(N),2),k=S[0],D=S[1],I=void 0!==k,E=f===X&&h,L=(null===w||void 0===w?void 0:w.creationDate)>0;return(0,r.jsxs)("div",{className:"soldisc bg-slate-800/40 text-slate-300 -mx-4 px-4 p-4 rounded-xl border border-white/20",children:[s.address&&(0,r.jsx)(W,B({},s,{setModalData:l})),(0,r.jsxs)("div",{className:"text-lg py-2",children:[(0,r.jsx)("span",{className:"font-display bg-gradient-to-r from-primary-400 to-secondary-500 bg-clip-text text-transparent",children:"SolDisc"})," ",(0,r.jsx)("span",{className:"text-sm text-slate-400 ml-1",children:"- On-Chain Discourse"})]}),E&&!I?(0,r.jsx)("div",{className:"flex justify-center m-4",children:"loading..."}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"border-y border-white/40 pt-3 mb-4",children:[(0,r.jsx)("p",{className:"text-slate-400 text-sm",children:"Leave a comment:"}),L?(0,r.jsx)(J,{address:h,userName:w.name,setModalData:l}):(0,r.jsx)("div",{children:(0,r.jsx)(p.II,{className:"mt-2",variant:"outlined",placeholder:"username",value:d,invalid:d&&!(4<=d.length&&d.length<=20),onChange:function(e){return u(e.target.value)}})}),E?(0,r.jsx)(V,{value:i,onChange:function(e){return c(e.target.value)},placeholder:L?"":"comment",onClick:function(){return(L?j.connect(x).commentOnPost(N,T().encode(i)):j.connect(x).createAccountAndComment(d,"",N,T().encode(i))).then(g).then(C).then(D).then((function(){return c("")})).catch(y)},text:L?"Comment":"Create Account & Comment",loadingText:L?"Commenting":"Creating Account & Commenting"}):(0,r.jsx)("div",{className:"flex justify-center m-4",children:f!==X?(0,r.jsx)(p.zx,{variant:"text",onClick:function(){!window.ethereum&&(0,p.tq)()?(0,p.Dy)():p.i8.activate(X)},children:"Connect to ".concat(p.zG[X].name)}):(0,r.jsx)(p.TI,{chainId:z.v.soldisc.chainId})})]}),!((null===k||void 0===k?void 0:k.length)>=1)&&(0,r.jsx)("p",{className:"text-center my-8",children:"No Comments yet"}),(0,r.jsx)("div",{className:"flex flex-col gap-y-4",children:I&&k&&k.map((function(e,n){return(0,r.jsx)(K,B({postHash:N,commentId:n,setModalData:l},e),n)})).reverse()})]})]})}var ne=!0;function te(e){var n,t=e.postData,l=(0,s.useRouter)().query.slug.includes("unpublished")||(null===t||void 0===t||null===(n=t.category)||void 0===n?void 0:n.includes("audit"));return(0,r.jsxs)("div",{className:"flex flex-col justify-between gap-y-20",children:[(0,r.jsxs)("div",{className:"content markdown",children:[(0,r.jsx)("h1",{className:"text-center",children:t.title}),t.suptitle&&(0,r.jsx)("h2",{className:"text-center",children:t.suptitle}),(0,r.jsx)("p",{className:"text-slate-500 text-sm text-center",children:t.date}),(0,r.jsx)(N,{className:"mt-16",trusted:!0,children:t.contentRaw})]}),!l&&(0,r.jsx)(ee,{slug:t.slug})]})}}},function(e){e.O(0,[265,634,774,888,179],(function(){return n=96082,e(e.s=n);var n}));var n=e.O();_N_E=n}]);