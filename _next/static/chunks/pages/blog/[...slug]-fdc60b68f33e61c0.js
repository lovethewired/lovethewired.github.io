(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[94],{96082:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/[...slug]",function(){return n(28419)}])},28419:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return J},default:function(){return K}});var r=n(85893),s=n(37684),l=n(97e3),a=n(75532),i=n(84283),c=n(87690),o=n(38522),d=n(68141),u=n(28907),h=n(71015),m=n(41664);n(97604);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}function v(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function p(e){var t=e.children,n=e.trusted,a=v(e,["children","trusted"]);return(0,r.jsx)(s.D,x({remarkPlugins:n?[l.Z,o.Z]:[l.Z],rehypePlugins:n?[d.Z,u.Z]:[],components:{h1:"h2",h2:"h3",code:function(e){return(0,r.jsx)(O,x({trusted:n},e))},a:function(e){var t=e.href,n=e.children,s=(e.node,v(e,["href","children","node"]));return/^https\:\/\//.test(t)?(0,r.jsx)(h.dL,x({href:t},s,{children:n})):(0,r.jsx)(m.default,x({href:t},s,{children:(0,r.jsx)("a",{children:n})}))}}},a,{children:t}))}function j(e){var t=e.linesHl,n=e.linesAdd,r=e.linesDel;return function(e){var s=e.rows,l=e.stylesheet,a=e.useInlineStyles;return s.map((function(e,s){return t&&t.includes(s)?e.properties.className=["line line-hl"]:n&&n.includes(s)?e.properties.className=["line line-add"]:r&&r.includes(s)?e.properties.className=["line line-del"]:e.properties.className=[],(0,c.ZP)({node:e,stylesheet:l,useInlineStyles:a,key:"code-segement".concat(s)})}))}}var g=/\/\/\s*(highlight|add|delete)-line$/gm,y=/\/\/\s*highlight-line$/,b=/\/\/\s*delete-line$/,N=/\/\/\s*add-line$/;function O(e){e.node;var t,n,s=e.inline,l=e.trusted,c=e.className,o=e.children,d=v(e,["node","inline","trusted","className","children"]),u=null===(t=/language-(?:diff-)*(.+)\b/.exec(c||""))||void 0===t?void 0:t[1],h=null===(n=/\b(\w+)\b$/.exec(c||""))||void 0===n?void 0:n[1];if(!h||s)return(0,r.jsx)("code",x({className:c},d,{children:o}));var m=u!==h?u:"",f=String(o).replace(/\n$/,""),p=[],O=[],w=[];return l&&(f.split("\n").forEach((function(e,t){y.test(e)?p.push(t):b.test(e)?w.push(t):N.test(e)&&O.push(t)})),f=f.replaceAll(g,"")),(0,r.jsx)(a.Z,x({language:h,style:i.YC,before:m,codeTagProps:{style:[]},wrapLines:!0,renderer:j({linesHl:p,linesAdd:O,linesDel:w}),className:""},d,{children:f}))}var w=n(67294),C=n(94184),S=n.n(C),k=n(38197),D=n(84243),P=n(9279),I=n(57458),E=n.n(I),_=n(67814),A=n(56024),L=n(51436),M=n(31838),T=n(12641);function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Z(e,t,n[t])}))}return e}function z(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,s,l=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);a=!0);}catch(c){i=!0,s=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw s}}return l}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Q=M.v.soldisc.chainId;function B(e){var t=(0,h.ti)();return(0,T.LQ)(M.v.soldisc.address,"getCommentsByPost",[e,t||P.d])}function U(e){e.value;var t=e.children,n=z(e,["value","children"]);return(0,r.jsx)("div",{className:"break-words",children:(0,r.jsx)(p,G({},n,{children:t}))})}function X(e){var t=e.address,n=e.userName,s=e.setModalData;return(0,r.jsx)("span",{className:"text-primary-400 link",onClick:function(){return s({address:t,userName:n})},children:n})}function q(e){var t=e.postHash,n=e.commentId,s=e.user,l=e.userName,a=e.text,i=e.creationDate,c=e.editDate,o=e.numLikes,d=e.liked,u=e.setModalData,m=(0,h.ti)(),f=(0,h.Mu)(),x=null===f||void 0===f?void 0:f.getSigner(),v=(0,T.GP)(),p=v.soldisc,j=v.handleTx,g=v.handleTxError,y=(0,w.useState)(!1),b=y[0],N=y[1],O=(0,w.useState)(""),C=O[0],k=O[1],D=H(B(t),2)[1],P=m===s,I=(0,h.xh)(M.v.soldisc.chainId);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-x-4 text-slate-400",children:[(0,r.jsx)(X,{address:s,userName:l,setModalData:u}),(0,r.jsx)("span",{className:"text-sm hidden sm:block",children:new Date(i.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),(0,r.jsxs)("span",{className:S()("text-sm",0==o&&"text-slate-500"),children:[o.toString(),(0,r.jsx)(_.G,{className:S()("ml-2 text-base transition-colors duration-200 cursor-pointer",d?"text-secondary-400 hover:text-slate-300":"text-slate-400 hover:text-secondary-400"),onClick:I((function(){t&&p.connect(x).toggleLikeComment(t,n).then(j).then(D).catch(g)})),icon:d?L.m6i:A.m6i})]}),c>0&&(0,r.jsxs)("span",{className:"text-sm text-slate-500 hidden sm:block",children:["(edited:"," ",new Date(c.mul(1e3).toNumber()).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),")"]})]}),b?(0,r.jsx)(F,{value:C,onChange:function(e){return k(e.target.value)},onClick:function(e){t&&p.connect(x).editComment(t,n,e).then(j).then((function(){return N(!1)})).then(D).catch(g)},onCancel:function(){return N(!1)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U,{children:a}),P&&t&&(0,r.jsx)("div",{className:"flex justify-center text-xs",children:(0,r.jsx)(h.zx,{className:"",variant:"text",onClick:function(){k(a),N(!0)},children:"Edit"})})]})]})}function F(e){var t,n=e.value,s=e.onClick,l=e.onChange,a=e.onCancel,i=e.placeholder,c=e.text,o=e.loadingText,d=(e.children,(0,w.useState)(!1)),u=d[0],m=d[1],f=E().encode(n),x=4<f.length&&f.length<1e3,v=(0,h.xh)(M.v.soldisc.chainId);return(0,r.jsxs)("div",{children:[(0,r.jsx)(h.II,{className:"mt-2",variant:"outlined",type:"multiline",placeholder:i,invalid:n&&!x,value:n,onChange:l}),n&&(0,r.jsx)("p",{className:"text-slate-400 my-2",children:"Preview:"}),(0,r.jsx)(U,{children:E().decode(f)}),(0,r.jsxs)("div",{className:"flex justify-center p-2",children:[a&&!u&&(0,r.jsx)(h.zx,{variant:"text",onClick:a,children:"Cancel"}),(0,r.jsx)(h.fl,{loading:u,disabled:!x,className:"",variant:"text",onClick:v((function(){m(!0),s(f).finally((function(){return m(!1)}))})),children:u?null!==(t=c&&o)&&void 0!==t?t:"Editing":null!==c&&void 0!==c?c:"Edit"})]})]})}function R(e){var t,n=e.userName,s=e.address,l=e.setModalData,a=H((t=s,console.log("here"),(0,T.LQ)(M.v.soldisc.address,"getCommentsByUser",[t])),1)[0],i=(0,h.pN)();return(0,r.jsx)(h.u_,{open:!!s,onClose:function(){return l({})},children:(0,r.jsxs)("div",{className:"bg-slate-900 flex flex-col p-8 max-w-xl",children:[(0,r.jsxs)("div",{className:"flex items-end gap-x-3",children:[(0,r.jsx)(h.dL,{href:(0,h.st)(i,s),children:(0,r.jsx)("h2",{className:"btn",children:n})}),(0,r.jsx)(h.dL,{href:(0,h.st)(i,s),children:(0,r.jsx)("span",{className:"",children:s})})]}),(0,r.jsx)("div",{className:"mt-4",children:void 0!==a&&a.map((function(e,t){return(0,r.jsx)(q,G({commentId:t,setModalData:l},e),t)})).reverse()})]})})}function Y(e){var t=e.slug,n=(0,w.useState)({}),s=n[0],l=n[1],a=(0,w.useState)(""),i=a[0],c=a[1],o=(0,w.useState)(""),d=o[0],u=o[1],m=(0,h.ti)(),f=(0,h.Mu)(),x=(0,h.pN)(),v=null===f||void 0===f?void 0:f.getSigner(),p=(0,T.GP)(),j=p.soldisc,g=p.handleTx,y=p.handleTxError,b=t.join("/");"2022/soldisc"===b&&(b="2021/soldisc");var N=k.keccak256(D.$.encode(["string"],[b])),O=H(function(e){return(0,T.LQ)(M.v.soldisc.address,"accounts",[e])}(m),2),C=O[0],S=O[1],P=H(B(N),2),I=P[0],_=P[1],A=void 0!==I,L=x===Q&&m,$=(null===C||void 0===C?void 0:C.creationDate)>0;return(0,r.jsxs)("div",{className:"soldisc bg-slate-800/40 text-slate-300 -mx-4 px-4 p-4 rounded-xl border border-white/20",children:[s.address&&(0,r.jsx)(R,G({},s,{setModalData:l})),(0,r.jsxs)("div",{className:"text-lg py-2",children:[(0,r.jsx)("span",{className:"font-display bg-gradient-to-r from-primary-400 to-secondary-500 bg-clip-text text-transparent",children:"SolDisc"})," ",(0,r.jsx)("span",{className:"text-sm text-slate-400 ml-1",children:"- On-Chain Discourse"})]}),L&&!A?(0,r.jsx)("div",{className:"flex justify-center m-4",children:"loading..."}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"border-y border-white/40 pt-3 mb-4",children:[(0,r.jsx)("p",{className:"text-slate-400 text-sm",children:"Leave a comment:"}),$?(0,r.jsx)(X,{address:m,userName:C.name,setModalData:l}):(0,r.jsx)("div",{children:(0,r.jsx)(h.II,{className:"mt-2",variant:"outlined",placeholder:"username",value:d,invalid:d&&!(4<=d.length&&d.length<=20),onChange:function(e){return u(e.target.value)}})}),L?(0,r.jsx)(F,{value:i,onChange:function(e){return c(e.target.value)},placeholder:$?"":"comment",onClick:function(){return($?j.connect(v).commentOnPost(N,E().encode(i)):j.connect(v).createAccountAndComment(d,"",N,E().encode(i))).then(g).then(S).then(_).then((function(){return c("")})).catch(y)},text:$?"Comment":"Create Account & Comment",loadingText:$?"Commenting":"Creating Account & Commenting"}):(0,r.jsx)("div",{className:"flex justify-center m-4",children:x!==Q?(0,r.jsx)(h.zx,{variant:"text",onClick:function(){!window.ethereum&&(0,h.tq)()?(0,h.Dy)():h.i8.activate(Q)},children:"Connect to ".concat(h.zG[Q].name)}):(0,r.jsx)(h.TI,{chainId:M.v.soldisc.chainId})})]}),!((null===I||void 0===I?void 0:I.length)>=1)&&(0,r.jsx)("p",{className:"text-center my-8",children:"No Comments yet"}),(0,r.jsx)("div",{className:"flex flex-col gap-y-4",children:A&&I&&I.map((function(e,t){return(0,r.jsx)(q,G({postHash:N,commentId:t,setModalData:l},e),t)})).reverse()})]})]})}var J=!0;function K(e){var t=e.postData;return(0,r.jsxs)("div",{className:"flex flex-col justify-between gap-y-20",children:[(0,r.jsxs)("div",{className:"content markdown",children:[(0,r.jsx)("h1",{className:"text-center",children:t.title}),t.suptitle&&(0,r.jsx)("h2",{className:"text-center",children:t.suptitle}),(0,r.jsx)("p",{className:"text-slate-500 text-sm text-center",children:t.date}),(0,r.jsx)(p,{className:"mt-16",trusted:!0,children:t.contentRaw})]}),(0,r.jsx)(Y,{slug:t.slug})]})}}},function(e){e.O(0,[265,249,774,888,179],(function(){return t=96082,e(e.s=t);var t}));var t=e.O();_N_E=t}]);