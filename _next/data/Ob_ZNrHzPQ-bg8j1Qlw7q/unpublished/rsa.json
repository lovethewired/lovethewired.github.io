{"pageProps":{"postData":{"slug":["unpublished","rsa"],"contentRaw":"\n*Notes taken from the [RSA paper](https://people.csail.mit.edu/rivest/Rsapaper.pdf)*.\n\n## Table of Contents\n\n## RSA\n\n$$\ndec(enc(M)) = M\n$$\n\n\nA *trap-door one-way function* allows a message $M$ to be encrypted as cyphertext $C$\ngiven a public (known) key / encryption method ($enc$).\n$C$ is only able to be deciphered in a reasonable time if the private key ($dec$) is known.\n\nFirst, assume that $M$ can be represented as an integer $\\in [0, n-1]$ (if not, break it into blocks).\nEncrypting/Decrypting $M$ with the public key ($e$, $n$) $\\in \\mathbb N^+$ works by:\n\n### Encrypting $M$\n$$\nC = enc(M) = M ^e \\quad (\\text {mod} \\; n)\n$$\n\n### Decrypting $C$\n$$\ndec(C) = C ^d \\quad (\\text {mod} \\; n)\n$$\n\n### Steps\n| Steps                                      | Variables                   |\n| ------------------------------------------ | --------------------------- |\n| find $p$ and $q$ two large prime numbers   | $p$, $q$ prime              |\n| calculate $n=pq$                           | $n = pq$                    |\n| calculate $\\phi (n) = (p - 1)(q - 1)$      | $\\phi (n) = (p - 1)(q - 1)$ |\n| pick $e$ relatively prime to $\\phi (n)$    | $e$                         |\n| pick $d$ mul inverse of $e$ mod $\\phi (n)$ | $d$                         |\n\nTo use RSA, one must find $p$ and $q$, two very large, random prime numbers.\n\nTheorem states\n\nThe security of the scheme relies on the fact that it is computationally infeasible to derive $p$ and $q$ from $n$.\n\n*Public key*: $[e, n]$\n*Private key*: $[d, n]$\n\n\n## Why does this work?\n\n$$\ndec(enc(M)) = (M^e)^d = M ^{ed} \\quad (\\text {mod} \\; n)\n$$\n\nWe would like to show that $M^{ed} \\; (\\text {mod} \\; n) \\overset ! = M$.\nWe know that $e$ and $d$ are multiplicative inverses ($\\text {mod} \\; \\phi (n)$):\n$$\ned \\equiv 1 \\quad (\\text{mod} \\; \\phi (n))\n$$\n\nThis means that there exists some $k \\in \\mathbb N^+$ s.t.\n$$\ned = k \\phi(n) + 1\n$$\n\nThis leads us to\n$$\n\\begin{equation}\n\\begin{align*}\nM^{ed} = M^{k \\phi(n) + 1} \n&= M^{k (p - 1)(q -1 ) + 1} \\\\\n&= M(M^{k(q - 1)})^{(p - 1)}\n\\end{align*}\n\\end{equation}\n$$\n\n\n### Fermat's little theoreom\n\n[Fermat's little theoreom](https://en.wikipedia.org/wiki/Fermat%27s_little_theorem) states that \n$$\na^p \\equiv a \\quad (\\text {mod} \\; p)\n$$\nfor any integer $a$ and prime $p$.\n\nIf $a \\not\\equiv 0 \\ (\\text {mod} \\; p)$, then\n$$\na^{(p - 1)} \\equiv 1 \\quad (\\text {mod} \\; p)\n$$\n\nUsing Fermat's little theorem in equation $(1)$, we can conclude that\n\n$$\n\\begin{align*}\nM^{ed} \n&= M(M^{k(q - 1)})^{(p - 1)} \\\\\n&\\equiv M \\quad (\\text{mod} \\; p)\n\\end{align*}\n$$\n\nUsing the same logic, we can show that \n\n$$\nM^{ed} \\equiv M \\quad (\\text{mod} \\; q)\n$$\n\n### Chinese remainder theoreom\n\nThe [Chinese remainder theorem](https://en.wikipedia.org/wiki/Chinese_remainder_theorem) (adapted to this case) states that:\n\nIf \n$x \\equiv M \\; (\\text{mod} \\; p)$\nand\n$x \\equiv M \\; (\\text{mod} \\; q)$\nfor two co-prime integers $p$, $q$\nthen\n$x \\equiv M \\; (\\text{mod} \\; pq)$\n\nUsing these two theorems, we conclude that \n$$\nM^{ed} \\equiv M \\; (\\text{mod} \\; n)\n$$\n\n\nQuestions:\n- why $\\phi$\n- Why $e$ relatively prime\n\n$$\n\\phi(n) = n \\prod _{p | n}(1 - \\frac 1 p) \n= n ( 1 - \\frac 1 p)(1 - \\frac 1 q)\n= n ( \\frac {p - 1}  p)(\\frac {q - 1} q)\n= (p - 1)(q - 1)\n$$\n\n\nhttps://eli.thegreenplace.net/2019/rsa-theory-and-implementation/","title":"RSA","date":"May 12, 2022","excerpt":"Taking a look at RSA","suptitle":"\"The era of 'electronic mail' may soon be upon us\"\n"}},"__N_SSG":true}