<!DOCTYPE html><html><head><meta charSet="utf-8"/><title class="animate__fadeIn">0xPhaze</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="next-head-count" content="3"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/802638926a2eb779.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/802638926a2eb779.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/5b6964bdff897f88.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/5b6964bdff897f88.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-dcf4136cb4ed4a3e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-10fac88913917d91.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-f2a13320fa311176.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-d2563c831d8a01f7.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/5423ad26-9ee507e8c57e7e9a.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/175675d1-b1f16020bd9e4fee.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/264-01fb23d8f50dfdd3.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-e2b689577b51a7c3.js" defer="" crossorigin=""></script><script src="/_next/static/x5f4kHXjRlrAhViHGaz-k/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/x5f4kHXjRlrAhViHGaz-k/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="app px-4 pb-20 min-h-screen flex flex-col items-center w-full max-w-screen"><header class="w-full flex flex-col px-4 sm:px-8 md:px-12 max-w-5xl sm:flex-row justify-between items-center border-white/20 overflow-hidden border-b p-4 h-16"><div class="w-full h-full flex flex-col sm:flex-row justify-start sm:justify-between items-center gap-y-4 overflow-hidden sm:overflow-visible"><div class="flex w-full sm:w-fit items-center"><h1 class="text-xl mx-auto font-display"><a href="/">0xPhaze</a></h1><div class="my-auto -ml-6 w-6 sm:hidden"><div class="text-slate-300 hover:text-secondary-400 transition-colors duration-200 cursor-pointer h-6"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"></path></svg></div></div></div><div class="flex flex-col sm:flex-row gap-x-8 md:gap-x-10 gap-y-4"><div class="flex gap-x-2 sm:gap-x-5 items-center justify-evenly"><a target="_blank" rel="noreferrer" class="link" href="https://github.com/0xPhaze/"><div><div class="text-slate-300 hover:text-secondary-400 transition-colors duration-200 cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4"><path style="fill:currentColor" d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></div></div></a><a target="_blank" rel="noreferrer" class="link" href="https://twitter.com/lovethewired"><div><div class="text-slate-300 hover:text-secondary-400 transition-colors duration-200 cursor-pointer"><svg viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-4"><path style="fill:currentColor" d="M15.584 1.578a7.91 7.91 0 0 1-1.57 1.807v.482c0 .965-.112 1.929-.336 2.772-.224.965-.673 1.808-1.121 2.652a17.373 17.373 0 0 1-1.794 2.29c-.785.723-1.681 1.205-2.578 1.566-1.01.362-2.13.603-3.252.603-1.793 0-3.475-.603-4.932-1.567h.784c1.458 0 2.915-.482 4.036-1.446a2.914 2.914 0 0 1-1.905-.723c-.561-.482-.897-.964-1.122-1.687h.561c.336 0 .56 0 .897-.12C2.579 8.085 1.907 7.603 1.458 7 .785 6.398.561 5.675.561 4.83c.449.242 1.01.362 1.458.483A5.531 5.531 0 0 1 .898 4.109C.673 3.626.449 3.024.449 2.42c0-.602.112-1.205.449-1.687a8.606 8.606 0 0 0 2.914 2.53c1.122.603 2.355.965 3.7 1.086 0-.241-.112-.483-.112-.844 0-.723.224-1.326.56-1.928.337-.603.897-.965 1.458-1.326.56-.241 1.233-.362 1.906-.12.672.12 1.233.481 1.681.964.673-.121 1.458-.362 2.018-.844-.224.844-.784 1.446-1.457 1.928.785-.12 1.457-.24 2.018-.602Z" fill="#081026"></path></svg></div></div></a><div><div class="text-slate-300 hover:text-secondary-400 transition-colors duration-200 cursor-pointer">ABI</div></div><div><div class="text-slate-300 hover:text-secondary-400 transition-colors duration-200 cursor-pointer">ENC</div></div></div><button class="rounded px-4 py-2 uppercase text-white select-none  transition-all duration-300 disabled:pointer-events-none bg-primary-600 hover:bg-primary-700  !outline-none normal-case text-sm w-[140px] w-36">Connect Wallet</button></div></div></header><main class="gap-y-20 mt-8 py-4 sm:px-8 md:px-12 w-full min-h-[500px] max-w-4xl"><div class="flex flex-col justify-between gap-y-20"><div class="content markdown"><h1 class="text-center">First steps to running Arbitrum Stylus</h1><h2 class="text-center">An auditor&#x27;s guide to Arbitrum Stylus</h2><p class="text-slate-500 text-sm text-center">May 1, 2024</p><div class="mt-16"><h2 id="nitro"><a href="/unpublished/arbitrum/stylus-nitro-intro#nitro"><span class="icon icon-link"></span></a>Nitro</h2>
<pre before="" class="codeblock" style="-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;white-space:pre-wrap;word-wrap:normal;font-family:Menlo, Monaco, &quot;Courier New&quot;, monospace;font-size:14px;color:#76d9e6;text-shadow:none;background:#2a2a2a;padding:15px;border-radius:4px;border:1px solid #e1e1e8;overflow:auto;position:relative"><code style="white-space:pre"><span><span>brew link go@1.20
</span></span><span>make build
</span><span>make wasm-ci-build</span></code></pre>
<ul>
<li>Builds <code>brotli</code> (<code>cmake</code>, <code>cc</code>)</li>
<li>Builds <code>jit</code> (<code>cargo</code>)</li>
<li>Compiles <code>contracts</code> (<code>yarn</code>, <code>forge</code>, <code>solc</code>)</li>
<li>Builds <code>nitro</code> (<code>go</code>)</li>
</ul>
<p>The <code>make all</code> command in Nitro&#x27;s Makefile triggers a sequence of build and test processes. Specifically, it executes the following high-level tasks:</p>
<ol>
<li>
<p><strong>Build Executables and Components (<code>build</code>)</strong>:</p>
<ul>
<li>This is a complex step involving multiple executables and components. The rule targets several binaries including <code>nitro</code>, <code>deploy</code>, <code>relay</code>, <code>daserver</code>, <code>datool</code>, <code>seq-coordinator-invalidate</code>, <code>nitro-val</code>, and <code>seq-coordinator-manager</code>. These are all built from their respective Go source files (<code>$(go_source)</code>) located in various directories (<code>$(repo_dirs)</code>). It is likely that Goâ€™s cross-compilation is leveraged for building specific architectures. This step utilizes conditional linking flags (<code>$(GOLANG_PARAMS)</code>) potentially defined by the environment to embed versioning or other metadata into the binaries.</li>
</ul>
</li>
<li>
<p><strong>Set Up the Replay Environment (<code>build-replay-env</code>)</strong>:</p>
<ul>
<li>Constructs the necessary environment for replaying blockchain transactions or similar events. This step compiles a WebAssembly binary (<code>$(replay_wasm)</code>) using Go, targeting the JavaScript/WebAssembly architecture. Additional components included are various <code>.wasm</code> libraries and a compressed machine representation (<code>machine.wavm.br</code>). These components are likely used for simulating or analyzing blockchain behavior in a controlled environment.</li>
</ul>
</li>
<li>
<p><strong>Generate Proof Tests (<code>test-gen-proofs</code>)</strong>:</p>
<ul>
<li>Generates proofs based on test cases written in WebAssembly text format (<code>.wat</code>) and Rust (<code>.rs</code>). This step transforms test cases into JSON formatted proof outputs that likely represent transaction validations or other proof verifications crucial for blockchain operations. This utilizes the prover executable (<code>$(arbitrator_prover_bin)</code>) to handle the transformation and proof generation.</li>
</ul>
</li>
</ol>
<p>Each of these primary tasks has detailed dependencies which are handled by other rules in the Makefile:</p>
<ul>
<li>
<p><strong>Dependency Management</strong>:</p>
<ul>
<li>Uses variables like <code>$(DEP_PREDICATE)</code> and <code>$(ORDER_ONLY_PREDICATE)</code> to manage dependencies especially in environments where Docker might affect file timestamps. The conditional setting of these variables controls whether dependencies are considered as order-only (ignoring timestamp changes).</li>
</ul>
</li>
<li>
<p><strong>Dynamic Linking Flags</strong>:</p>
<ul>
<li>Conditional rules add flags to <code>GOLANG_LDFLAGS</code> based on environment variables, affecting how Go binaries are linked during the build process. This could include embedding the build version, date, and whether the source code has been modified.</li>
</ul>
</li>
<li>
<p><strong>Auxiliary Build Processes</strong>:</p>
<ul>
<li>Other targets in the Makefile handle building WebAssembly libraries, managing Rust dependencies, formatting code, and running linters. These support the main build and testing processes.</li>
</ul>
</li>
<li>
<p><strong>Environment and Configuration</strong>:</p>
<ul>
<li>Various environment variables (like <code>WASI_SYSROOT</code>) and configuration settings influence how binaries and libraries are built, particularly for targeting different platforms like WebAssembly.</li>
</ul>
</li>
</ul>
<p>Finally, after completing these primary tasks (<code>all</code> target), a file named <code>.make/all</code> is touched to signify that the <code>all</code> target has successfully completed, serving as a marker for dependency management in future builds.</p>
<p>Overall, the <code>make all</code> command coordinates building the software, setting up necessary environments for transaction replay, and generating test proofs crucial for ensuring the correctness and reliability of blockchain-related operations managed by this software.</p>
<h2 id="testing"><a href="/unpublished/arbitrum/stylus-nitro-intro#testing"><span class="icon icon-link"></span></a>Testing</h2>
<h3 id="arbitrator"><a href="/unpublished/arbitrum/stylus-nitro-intro#arbitrator"><span class="icon icon-link"></span></a>Arbitrator</h3></div></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"postData":{"slug":["unpublished","arbitrum","stylus-nitro-intro"],"contentRaw":"\n# Nitro\n\n```\nbrew link go@1.20\nmake build\nmake wasm-ci-build\n```\n\n- Builds `brotli` (`cmake`, `cc`)\n- Builds `jit` (`cargo`)\n- Compiles `contracts` (`yarn`, `forge`, `solc`)\n- Builds `nitro` (`go`)\n\nThe `make all` command in Nitro's Makefile triggers a sequence of build and test processes. Specifically, it executes the following high-level tasks:\n\n1. **Build Executables and Components (`build`)**:\n\n   - This is a complex step involving multiple executables and components. The rule targets several binaries including `nitro`, `deploy`, `relay`, `daserver`, `datool`, `seq-coordinator-invalidate`, `nitro-val`, and `seq-coordinator-manager`. These are all built from their respective Go source files (`$(go_source)`) located in various directories (`$(repo_dirs)`). It is likely that Goâ€™s cross-compilation is leveraged for building specific architectures. This step utilizes conditional linking flags (`$(GOLANG_PARAMS)`) potentially defined by the environment to embed versioning or other metadata into the binaries.\n\n2. **Set Up the Replay Environment (`build-replay-env`)**:\n\n   - Constructs the necessary environment for replaying blockchain transactions or similar events. This step compiles a WebAssembly binary (`$(replay_wasm)`) using Go, targeting the JavaScript/WebAssembly architecture. Additional components included are various `.wasm` libraries and a compressed machine representation (`machine.wavm.br`). These components are likely used for simulating or analyzing blockchain behavior in a controlled environment.\n\n3. **Generate Proof Tests (`test-gen-proofs`)**:\n   - Generates proofs based on test cases written in WebAssembly text format (`.wat`) and Rust (`.rs`). This step transforms test cases into JSON formatted proof outputs that likely represent transaction validations or other proof verifications crucial for blockchain operations. This utilizes the prover executable (`$(arbitrator_prover_bin)`) to handle the transformation and proof generation.\n\nEach of these primary tasks has detailed dependencies which are handled by other rules in the Makefile:\n\n- **Dependency Management**:\n  - Uses variables like `$(DEP_PREDICATE)` and `$(ORDER_ONLY_PREDICATE)` to manage dependencies especially in environments where Docker might affect file timestamps. The conditional setting of these variables controls whether dependencies are considered as order-only (ignoring timestamp changes).\n- **Dynamic Linking Flags**:\n\n  - Conditional rules add flags to `GOLANG_LDFLAGS` based on environment variables, affecting how Go binaries are linked during the build process. This could include embedding the build version, date, and whether the source code has been modified.\n\n- **Auxiliary Build Processes**:\n\n  - Other targets in the Makefile handle building WebAssembly libraries, managing Rust dependencies, formatting code, and running linters. These support the main build and testing processes.\n\n- **Environment and Configuration**:\n  - Various environment variables (like `WASI_SYSROOT`) and configuration settings influence how binaries and libraries are built, particularly for targeting different platforms like WebAssembly.\n\nFinally, after completing these primary tasks (`all` target), a file named `.make/all` is touched to signify that the `all` target has successfully completed, serving as a marker for dependency management in future builds.\n\nOverall, the `make all` command coordinates building the software, setting up necessary environments for transaction replay, and generating test proofs crucial for ensuring the correctness and reliability of blockchain-related operations managed by this software.\n\n# Testing\n\n## Arbitrator\n","title":"First steps to running Arbitrum Stylus","date":"May 1, 2024","suptitle":"An auditor's guide to Arbitrum Stylus"}},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["unpublished","arbitrum","stylus-nitro-intro"]},"buildId":"x5f4kHXjRlrAhViHGaz-k","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>